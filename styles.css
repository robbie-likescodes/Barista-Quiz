/* =========================================================
   Barista Flashcards & Quizzes — styles.css (mobile-first)
   - Smooth mobile menu (never scrollable)
   - Sticky header
   - Responsive cards & grids
   - Accessible focus styles
   - Toast/Snackbar
   - Matches latest HTML/JS IDs & classes
========================================================= */

:root{
  --bg:#f5f3ee; --panel:#ffffff; --panel2:#f8f4ee; --text:#1f2a33; --muted:#6b7280;
  --brand:#2bb673; --primary:#3b82f6; --success:#22c55e; --danger:#ef4444;
  --line:rgba(15,23,42,.08); --chip:#eef6f0;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;color:var(--text);
  background:radial-gradient(1200px 600px at 20% -10%,#f7f3ec 0%,#f5f3ee 45%,#f1efe9 100%);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  -webkit-tap-highlight-color: transparent;
}
.container{max-width:1050px;margin:16px auto;padding:0 16px 80px}

/* ======================= Header / Menu ======================= */
.app-header{
  position:sticky;top:0;z-index:20;
  background:linear-gradient(90deg,#ffffff,#f7f3ec);
  border-bottom:1px solid var(--line)
}
.brand{display:flex;align-items:center;gap:12px;padding:14px 16px 8px}
.logo{font-size:22px}
h1{margin:0;font-size:28px;letter-spacing:.3px}

.topnav{display:flex;align-items:center;justify-content:flex-end;padding:6px 16px 12px}

/* Menu container (never scrollable) */
.menu{position:relative;z-index:1000;overflow:visible}

/* Menu button – large touch target */
#menuBtn{
  position:relative;
  border:1px solid var(--line);
  background:#ffffff;color:var(--text);
  padding:10px 14px;border-radius:10px;
  font-weight:700;letter-spacing:.2px;cursor:pointer;
  transition:transform .12s ease, filter .12s ease;
  will-change: transform;
  -webkit-tap-highlight-color: transparent;
}
#menuBtn:hover{ filter:brightness(1.06) }
#menuBtn:active{ transform:translateY(1px) }
#menuBtn:focus-visible{ outline:2px solid var(--brand); outline-offset:2px }

/* Dropdown panel (animated; NEVER scrollable) */
.menu-list{
  position:absolute;right:0;top:calc(100% + 8px);
  min-width:220px;
  background:linear-gradient(180deg,#ffffff,#f7f3ec);
  border:1px solid var(--line);border-radius:12px;
  box-shadow:0 16px 40px rgba(15,23,42,.15);
  padding:8px;

  display:block;  /* keep in flow for animation math */
  opacity:0;pointer-events:none;transform:translateY(-6px) scale(.98);
  transform-origin: top right;
  transition:opacity .16s ease, transform .16s ease;

  /* ensure no scrollbars/indicators ever show */
  max-height:none; overflow:hidden;
}
.menu-list.open{
  opacity:1;pointer-events:auto;transform:translateY(0) scale(1);
  /* still not scrollable per requirement */
  overflow:hidden;
}

/* Hide any scrollbar visuals defensively */
.menu-list::-webkit-scrollbar{display:none}
.menu-list{scrollbar-width:none}

/* Reduce motion */
@media (prefers-reduced-motion: reduce){
  .menu-list{ transition:none }
  #menuBtn{ transition:none }
}

/* Menu items */
.menu-item{
  display:block;width:100%;text-align:left;
  padding:12px;margin:4px 0;border-radius:10px;
  border:1px solid var(--line);background:#ffffff;color:var(--text);
  cursor:pointer;font-weight:600;transition:background .12s ease, filter .12s ease;
}
.menu-item:hover{ filter:brightness(0.98) }
.menu-item.active{ background:var(--brand);color:#ffffff;border-color:transparent }
.menu-item:focus-visible{ outline:2px solid var(--brand); outline-offset:2px }

/* Hide admin routes in student mode */
body.student .menu-item[data-route="create"],
body.student .menu-item[data-route="build"],
body.student .menu-item[data-route="reports"]{display:none}

/* ============================ Views ========================== */
.view{display:none}
.view.active{display:block}

/* ====================== Cards / Layout ======================= */
.card{
  position:relative;background:var(--panel);
  border:1px solid var(--line);border-radius:14px;padding:16px;margin:16px 0;
  box-shadow:0 10px 30px rgba(15,23,42,.08)
}
.card.primary-card{border-color:color-mix(in oklab,var(--brand) 45%,var(--line) 55%);box-shadow:0 14px 40px rgba(15,23,42,.12)}
.card.bulk-card{background:linear-gradient(180deg,#ffffff,#f2f7f2)}
.card.filters-card{position:sticky;top:76px;z-index:5}
.folder-card .card-head{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.folder-tree{display:grid;gap:14px;margin-top:12px}
.folder-group{border:1px solid rgba(86, 60, 40, 0.12);border-radius:14px;padding:10px 12px;background:#fff}
.folder-group>summary{display:flex;align-items:center;justify-content:space-between;font-weight:700;cursor:pointer}
.folder-group>summary .count{font-size:12px;color:#7f6a55}
.folder-decks{display:grid;gap:12px;margin-top:10px}
.folder-deck{border:1px solid rgba(86, 60, 40, 0.08);border-radius:12px;padding:10px;background:#fffdfa}
.folder-row{display:flex;align-items:center;gap:10px;justify-content:space-between}
.folder-link{display:inline-flex;align-items:center;gap:8px;border:1px solid transparent;background:transparent;color:#1f2937;font-weight:600;cursor:pointer;padding:6px 8px;border-radius:8px}
.folder-link .meta{font-weight:500;color:#8b6d55;font-size:12px}
.folder-link.selected{background:#fff3da;border-color:rgba(252, 196, 75, 0.5)}
.folder-subs{display:grid;grid-template-columns:repeat(auto-fit, minmax(180px, 1fr));gap:8px;margin-top:10px}
.folder-subs .folder-link{justify-content:space-between;font-weight:500;background:#ffffff;border:1px dashed rgba(86, 60, 40, 0.16)}
.folder-subs .folder-link.selected{background:#ffe8c3;border-style:solid}
.folder-subs .count{background:#fff4d8;border-radius:999px;padding:2px 8px;font-size:11px;color:#7a5a44}
.btn.tiny{padding:4px 10px;font-size:12px}
.card-head{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
.grow{flex:1}
.mt{margin-top:14px}.mt-sm{margin-top:8px}.mt-xs{margin-top:4px}
.lead{font-size:18px}
.hint{color:var(--muted);font-size:13px}
.footer #outboxStatus{position:relative;padding-left:16px}
.footer #outboxStatus::before{
  content:"";position:absolute;left:0;top:50%;transform:translateY(-50%);
  width:8px;height:8px;border-radius:50%;background:#7a829a;border:1px solid var(--line)
}
.footer #outboxStatus.pending{ color: var(--primary); font-weight:600; }
.footer #outboxStatus.pending::before{background:var(--primary)}
.hidden{display:none!important}

/* Avoid overflow of action buttons on small screens */
.card .card-head .btn{white-space:nowrap}
.card .card-head{row-gap:8px}

/* Grids */
.grid{display:grid;gap:12px}
.grid.g2{grid-template-columns:repeat(2,minmax(0,1fr))}
.grid.g3{grid-template-columns:repeat(3,minmax(0,1fr))}
@media (max-width:800px){.grid.g2,.grid.g3{grid-template-columns:1fr}}

/* ================= Inputs & selects ========================== */
.input,select{
  width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--line);
  background:var(--panel2);color:var(--text);line-height:1.2;pointer-events:auto;position:relative;z-index:2
}
select.input{-webkit-appearance: menulist;appearance: menulist}
.input.small{max-width:120px}
.textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:var(--panel2);color:var(--text)}
.label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
.select-wrap{position:relative;z-index:2}

/* NEW: tighten stacked filter rows on narrow screens */
@media (max-width:800px){
  .select-wrap + .select-wrap { margin-top: 6px; }
}

/* ======================== Buttons ============================ */
.btn{
  border:1px solid transparent;border-radius:12px;padding:10px 14px;
  background:#ffffff;color:var(--text);cursor:pointer;font-weight:600;border-color:var(--line)
}
.btn:hover{filter:brightness(1.05)}
.btn.primary{background:var(--primary);color:#ffffff;border-color:transparent}
.btn.success{background:var(--success);color:#ffffff;border-color:transparent}
.btn.danger{background:var(--danger);color:#ffffff;border-color:transparent}
.btn.ghost{background:transparent;border-color:var(--line)}
.btn.small{padding:7px 10px;font-size:13px}

/* Subtle icon spacing if you add icons later */
.btn .ico{display:inline-block;margin-right:8px;line-height:0}

/* ======================== Lists ============================== */
.list .cardline{
  display:grid;grid-template-columns:1.3fr 1fr auto;gap:12px;
  padding:12px;border-radius:10px;background:var(--panel2);margin:10px 0
}
.list .cardline:nth-child(even){background:#f4f7f9}
.list .actions{display:flex;gap:8px;justify-content:flex-end;align-items:center}
@media (max-width:800px){.list .cardline{grid-template-columns:1fr}}

/* ================= Deck chooser (Build) ====================== */
.deck-pick .deck-row{
  border:1px dashed var(--line);border-radius:12px;padding:12px;margin:10px 0;background:#f8fafc
}
.deck-pick .top{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.wrap{display:flex;align-items:center;gap:10px}
.subs{margin-top:10px;display:flex;flex-wrap:wrap;gap:10px}
.subchip{display:flex;align-items:center;gap:6px;background:var(--chip);border:1px solid var(--line);padding:6px 10px;border-radius:12px}

/* ======================== Chips ============================== */
.chips{display:flex;flex-wrap:wrap;gap:10px}
.chip{
  display:flex;align-items:center;gap:8px;border:1px solid var(--line);
  background:#ffffff;padding:8px 12px;border-radius:999px
}
.chip .remove{background:none;border:none;color:var(--muted);cursor:pointer;font-size:14px;line-height:1;padding:0}
.chip .remove:hover{color:var(--danger)}

/* ======================== Switch ============================= */
.switch{display:flex;align-items:center;gap:8px}
.switch input{transform:scale(1.2)}

/* ===================== Flashcard (Practice) ================== */
.flip{position:relative;perspective:1200px;min-height:180px}
.flip .front,.flip .back{
  border-radius:12px;border:1px solid var(--line);background:var(--panel2);
  padding:18px;position:absolute;inset:0;backface-visibility:hidden;
  transition:transform .5s ease;display:flex;flex-direction:column;justify-content:center
}
.flip .front{transform:rotateY(0)} .flip .back{transform:rotateY(180deg)}
.flip.flipped .front{transform:rotateY(180deg)} .flip.flipped .back{transform:rotateY(360deg)}
.fc-title{color:var(--muted);text-transform:uppercase;letter-spacing:.12em;font-size:12px;margin-bottom:6px}
.fc-text{font-size:18px}
#practiceCard{cursor:pointer}
#practiceCard:focus-visible .front,#practiceCard:focus-visible .back{box-shadow:0 0 0 2px var(--brand) inset}

/* ======================== Quiz =============================== */
.options{display:grid;gap:10px}
.option{
  display:flex;align-items:center;gap:10px;padding:12px;border-radius:12px;
  border:1px solid var(--line);background:#ffffff
}
@media (max-width:720px){
  .option{padding:14px 12px;font-size:16px}
}
.option.correct{border-color:#2bd4a9;background:rgba(43,212,169,.08)}
.option.incorrect{border-color:#e87070;background:rgba(232,112,112,.08)}
.option.disabled{opacity:.7;pointer-events:none}
.bar{display:flex;align-items:center;gap:14px}

/* ================ Answers (review) =========================== */
.answers .row{border:1px solid var(--line);border-radius:12px;padding:10px;margin:8px 0;background:#ffffff}
.answers .q{font-weight:600;margin-bottom:4px}
.answers .a{display:flex;flex-wrap:wrap;gap:8px}
.tag{padding:4px 8px;border-radius:999px;border:1px solid var(--line);background:#f1f5f9}
.tag.good{background:rgba(43,212,169,.1);border-color:#2bd4a9;color:#bdf6e7}
.tag.bad{background:rgba(232,112,112,.1);border-color:#e87070;color:#ffd4d4}

/* ========================= Table ============================= */
.table-wrap{overflow:auto}
.table{width:100%;border-collapse:collapse}
.table th,.table td{border-bottom:1px solid rgba(255,255,255,.05);padding:10px 8px;text-align:left;vertical-align:middle}
.table th{
  color:color-mix(in oklab,var(--muted) 85%,white 15%);font-weight:600;font-size:12px;
  text-transform:uppercase;letter-spacing:.08em;white-space:nowrap;background:#f1f5f9
}
.table .view-btn{white-space:nowrap}

/* ===================== Missed summary ======================== */
.missed{display:flex;flex-direction:column;gap:10px}
.missed .missrow{display:flex;gap:10px;align-items:flex-start}
.missed .missq{flex:1}
.missed .misscount{min-width:60px;text-align:center;border:1px solid var(--line);background:#ffffff;border-radius:10px;padding:6px}

/* =================== Location Averages ======================= */
#locationAverages .missrow{align-items:center}

/* ========================== Toast ============================ */
.toast{
  position:fixed;left:50%;bottom:18px;transform:translateX(-50%) translateY(20px);
  background:#ffffff;border:1px solid var(--line);color:var(--text);padding:10px 14px;
  border-radius:10px;box-shadow:0 10px 30px rgba(15,23,42,.18);opacity:0;
  transition:opacity .18s ease, transform .18s ease;z-index:2000;pointer-events:none
}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* ========================= Footer ============================ */
.footer{text-align:center;padding:30px 0;color:var(--muted)}

/* =============== Utility & Accessibility ===================== */
.sr-only{
  position:absolute!important;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;
  clip:rect(0,0,0,0);white-space:nowrap;border:0
}
.noscript{background:#ffdede;color:#3a0b0b;padding:8px 12px;text-align:center;font-weight:600}
.micro{font-size:12px;color:var(--muted);opacity:.9}
kbd{
  font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace;font-size:12px;line-height:1;
  display:inline-block;padding:4px 6px;border:1px solid var(--line);border-bottom-width:2px;border-radius:6px;background:#ffffff;
  box-shadow:0 1px 0 rgba(255,255,255,.6) inset,0 1px 0 rgba(15,23,42,.15)
}
:focus-visible{outline:2px solid color-mix(in oklab,var(--brand) 70%,white 0%);outline-offset:2px}
.btn:focus-visible,.input:focus-visible,select.input:focus-visible,.menu-item:focus-visible{outline:2px solid var(--brand);outline-offset:2px}

/* ==================== Minor polish tweaks ==================== */
/* Animate optional sub-deck reveal in Create */
#newSubdeck{transition:max-height .25s ease,opacity .2s ease;max-height:120px}
#newSubdeck.hidden{max-height:0;opacity:0;overflow:hidden}

/* Ensure select popups remain tappable on iOS */
.select-wrap{isolation:isolate}

/* Slightly tighter headers/buttons on narrow screens */
@media (max-width:720px){
  #menuBtn{padding:9px 12px}
  .menu-item{padding:10px 12px}
  .brand h1{font-size:22px}
}

/* ===================== Create view meta ====================== */
#deckMeta{display:grid;gap:6px}
#deckMetaTitle{
  display:inline-block;padding:6px 10px;border:1px solid var(--line);
  border-radius:10px;background:#ffffff;font-size:13px
}
#deckMetaSubs{display:flex;flex-wrap:wrap;gap:8px}
#deckMetaSubs .chip{background:var(--chip);border:1px solid var(--line);border-radius:999px;padding:6px 10px;font-size:12px;color:var(--text)}
#deckMetaSubs .chip .remove{margin-left:4px;color:var(--muted);background:none;border:none;cursor:pointer;font-size:14px;line-height:1}
#deckMetaSubs .chip .remove:hover{color:var(--danger)}
#subdeckManager{background:linear-gradient(180deg,#ffffff,#f5f7f2);border:1px solid var(--line);border-radius:12px;padding:12px}
#subdeckManager>summary.card-head{cursor:pointer}
#subdeckManagerList{display:flex;flex-wrap:wrap;gap:8px}
#subdeckManagerList .chip{padding:6px 10px;font-size:12px}
#subdeckManager .grid.g2 .input{min-width:0}
#deckSelect.input{background:linear-gradient(0deg,rgba(255,255,255,0.02),rgba(255,255,255,0.02)),var(--panel2)}
#newClassName,#newDeckName,#newSubdeck,#subdeckNewName{background:linear-gradient(0deg,rgba(255,255,255,0.02),rgba(255,255,255,0.02)),var(--panel2)}
#view-create .card .card-head strong{white-space:nowrap}
@media (max-width:800px){
  #deckMetaTitle{font-size:12px}
  #deckMetaSubs .chip{font-size:11px;padding:5px 8px}
}

/* NEW: Create — sub-deck filter positioning */
#cardsSubFilter.input{ background:linear-gradient(0deg,rgba(255,255,255,0.02),rgba(255,255,255,0.02)),var(--panel2) }

/* NEW: Reports — date/test filter inputs inherit .input styling; keep spacing tight */
#repDateFrom.input,#repDateTo.input,#repTest.input{ background:linear-gradient(0deg,rgba(255,255,255,0.02),rgba(255,255,255,0.02)),var(--panel2) }

/* ========= Small additions for Cloud controls (admin only) === */
/* Buttons already use .btn; these tighten spacing when many actions are in the header */
#cloudPullBtn,#cloudPushBtn{ }
#repCloudPullBtn{ }

/* Optional status dot you can toggle from JS later (not shown to students) */
.status-dot{
  display:inline-block;width:8px;height:8px;border-radius:50%;
  margin-left:8px;background:#7a829a;border:1px solid var(--line);vertical-align:middle
}
.status-dot.online{ background:var(--success) }
.status-dot.offline{ background:var(--danger) }
