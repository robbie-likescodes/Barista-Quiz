<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Barista Flashcards & Quizzes</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <header class="appbar">
    <div class="brand">☕ Barista Flashcards & Quizzes</div>
    <nav class="tabs">
      <button class="tab" data-route="create">Create</button>
      <button class="tab" data-route="build">Build Test</button>
      <button class="tab" data-route="practice">Practice</button>
      <button class="tab" data-route="quiz">Quiz</button>
      <button class="tab" data-route="reports">Reports</button>
      <button class="tab" data-route="mine">My Results</button>
    </nav>
    <span id="modeBadge" class="badge"></span>
  </header>

  <main id="view-create" class="view">
    <h2>Create & Manage Cards</h2>

    <section class="card">
      <h3>Add a deck (or pick an existing)</h3>
      <div class="grid g2">
        <div>
          <label>Class</label>
          <input id="clsName" list="clsList" placeholder="e.g., Barista Training"/>
          <datalist id="clsList"></datalist>
        </div>
        <div>
          <label>Deck</label>
          <input id="deckName" list="deckList" placeholder="e.g., Handbook"/>
          <datalist id="deckList"></datalist>
        </div>
      </div>
      <div class="grid g2">
        <div>
          <label>Sub‑deck (optional)</label>
          <input id="subdeckName" placeholder="e.g., Introduction"/>
        </div>
        <div class="right">
          <button id="btnAddDeck" class="primary">Add / Select Deck</button>
        </div>
      </div>

      <div class="spacer"></div>

      <label>Pick deck (by deck name)</label>
      <select id="pickDeckByName"></select>
    </section>

    <section class="card">
      <details>
        <summary>Bulk Add (tap for format)</summary>
        <div class="muted">Format (one per line): <code>Question | Correct | Wrong1 | Wrong2 | Wrong3 | #Subdeck(optional)</code></div>
      </details>
      <textarea id="bulkText" rows="6" placeholder="Question | Correct | Wrong1 | Wrong2 | Wrong3 | #Subdeck(optional)"></textarea>
      <div class="right">
        <button id="btnBulkAdd" class="primary">Add to Deck</button>
      </div>
    </section>

    <section class="card">
      <h3>Add / Edit Single Card</h3>
      <div class="grid g2 g2-600">
        <input id="q" placeholder="Question"/>
        <input id="a" placeholder="Correct answer"/>
        <input id="w1" placeholder="Wrong answer 1 (required)"/>
        <input id="w2" placeholder="Wrong answer 2 (optional)"/>
        <input id="w3" placeholder="Wrong answer 3 (optional)"/>
        <input id="sd" placeholder="Card sub‑deck (optional)"/>
      </div>
      <div class="right">
        <button id="btnSaveCard" class="primary">Save Card</button>
      </div>
    </section>
  </main>

  <main id="view-build" class="view hidden">
    <h2>Build Test & Share</h2>

    <section class="card">
      <label><input type="checkbox" id="previewAsStudent"> Preview as Barista</label>
      <div class="grid g3 g2-900 g1-600">
        <div>
          <label>Create or select a Test</label>
          <input id="testName" list="testList" placeholder="e.g., Handbook Test"/>
          <datalist id="testList"></datalist>
        </div>
        <div>
          <label>Title shown to barista</label>
          <input id="testTitle" placeholder="e.g., Barista Basics"/>
        </div>
        <div>
          <label>Total Questions</label>
          <input id="testCount" type="number" min="1" max="200" value="30"/>
        </div>
      </div>
      <div class="row">
        <button id="btnSaveTest" class="primary">Save/Select Test</button>
        <button id="btnDeleteTest" class="danger">Delete Test</button>
      </div>

      <h4>Share</h4>
      <div class="row">
        <button id="btnCopyStudent" class="success">Copy Student Link</button>
        <button id="btnOpenStudent" class="">Open Student Preview</button>
      </div>
      <p class="muted small">Student link is restricted: no Create/Build/Reports; only the shared Test is visible.</p>
    </section>

    <section class="card">
      <details open>
        <summary>Choose content (Class → Deck → Sub‑deck)</summary>
        <div id="chooseTree"></div>
      </details>
    </section>
  </main>

  <main id="view-practice" class="view hidden">
    <h2>Practice</h2>
    <section class="card">
      <div class="grid g2 g1-600">
        <div>
          <label>Select Test</label>
          <select id="practiceTest"></select>
        </div>
        <div>
          <label>Pick which classes/decks you want to study</label>
          <div id="practiceTree" class="treeBox"></div>
        </div>
      </div>
      <div class="row">
        <button id="btnStartPractice" class="primary">Start Practice</button>
      </div>
      <div id="practiceStage" class="stage hidden"></div>
    </section>
  </main>

  <main id="view-quiz" class="view hidden">
    <h2>Quiz</h2>
    <section class="card">
      <div class="grid g3 g2-900 g1-600">
        <div>
          <label>Select Test</label>
          <select id="quizTest"></select>
        </div>
        <div>
          <label>Your name (required)</label>
          <input id="studentName" placeholder="First"/>
        </div>
        <div>
          <label>Location (required)</label>
          <input id="studentLoc" placeholder="Store/City"/>
        </div>
      </div>
      <div class="grid g2 g1-600">
        <div>
          <label>Date</label>
          <input id="studentDate" type="date"/>
        </div>
        <div class="right">
          <button id="btnStartQuiz" class="primary">Start Quiz</button>
        </div>
      </div>
      <div id="quizStage" class="stage hidden"></div>
    </section>
  </main>

  <main id="view-reports" class="view hidden">
    <h2>Reports (Admin)</h2>
    <section class="card">
      <div class="grid g4 g2-900 g1-600">
        <div><label>Filter by Test</label><select id="repTest"></select></div>
        <div><label>Filter by Location</label><select id="repLocation"><option value="">All</option></select></div>
        <div><label>Sort by</label>
          <select id="repSort">
            <option value="dateDesc">Date (newest)</option>
            <option value="dateAsc">Date (oldest)</option>
            <option value="scoreDesc">Score (high→low)</option>
            <option value="scoreAsc">Score (low→high)</option>
          </select>
        </div>
        <div class="right"><label>&nbsp;</label><button id="btnExportCSV">Export CSV</button></div>
      </div>
      <div id="repTable"></div>
    </section>

    <section class="card">
      <h3>Most missed questions</h3>
      <div id="repMissed"></div>
    </section>
  </main>

  <main id="view-mine" class="view hidden">
    <h2>My Results</h2>
    <section class="card">
      <div id="mineTable"></div>
    </section>
  </main>

  <template id="tpl-question">
    <div class="qcard">
      <div class="qtext"></div>
      <div class="opts"></div>
    </div>
  </template>

  <script src="app.js"></script>
</body>
</html>
